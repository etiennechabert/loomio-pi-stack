# Google Drive Sync Monitoring
# Alerts if sync to Google Drive fails or is too old

# Sync age alarm
alarm: loomio_gdrive_sync_old
   on: loomio_gdrive_sync.age
 lookup: average -1m unaligned
  units: seconds
  every: 1m
   warn: $this > 7200
   crit: $this > 14400
  delay: down 5m multiplier 1.5 max 1h
   info: Last successful Google Drive sync is old (warning at 2h, critical at 4h)
     to: sysadmin

# Sync status alarm  
alarm: loomio_gdrive_sync_failed
   on: loomio_gdrive_sync.status
 lookup: average -1m unaligned
  units: status
  every: 1m
   crit: $this == 0
  delay: down 5m multiplier 1.5 max 1h
   info: Google Drive sync has failed or never run
     to: sysadmin
